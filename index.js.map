{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///index.js","webpack:///webpack/bootstrap e38e4f621af35a4d30a2","webpack:///./src/Compress.js","webpack:///./src/core/base64.js","webpack:///./src/core/converter.js","webpack:///./src/core/file.js","webpack:///./src/core/image.js","webpack:///./src/core/Photo.js","webpack:///./src/core/rotate.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","global","apply","undefined","_base","_converter","_file","_image","_Photo","_rotate","_interopRequireDefault","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_base2","_converter2","_file2","_image2","_Photo2","_rotate2","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","Compress","el","options","outputType","_this","Promise","resolve","input","document","querySelector","setAttribute","addEventListener","evt","output","compress","concat","files","compressFile","file","photo","start","window","performance","now","alt","name","ext","type","startSize","size","orientation","then","load","compressImage","src","img","startWidth","naturalWidth","startHeight","naturalHeight","resize","_Image$resize","maxWidth","maxHeight","width","height","endWidth","endHeight","imageToCanvas","canvas","iterations","base64prefix","prefix","loopCompression","quality","minQuality","base64","finalSize","data","end","difference","elapsedTimeInSeconds","initialSizeInMb","MB","endSizeInMb","endWidthInPx","endHeightInPx","initialWidthInPx","initialHeightInPx","sizeReducedInPercent","arguments","targetQuality","targetSize","base64str","canvasToBase64","newSize","all","map","File","convertBase64ToFile","mime","base64ToFile","len","replace","split","match","byteString","atob","content","charCodeAt","Blob","Uint8Array","createElement","context","getContext","image","drawImage","translate","scale","rotate","Math","PI","toDataURL","KB","reject","fileReader","FileReader","result","err","readAsDataURL","Image","targetWidth","targetHeight","originalAspectRatio","outputWidth","outputHeight","min","Photo","_ref","_ref$quality","_ref$size","_ref$maxWidth","_ref$maxHeight","_ref$resize","b","endSize","reader","onload","event","view","DataView","f","getUint16","marker","byteLength","offset","j","getUint32","little","tags","_m4","readAsArrayBuffer","slice"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports,__webpack_require__(1),__webpack_require__(2),__webpack_require__(3),__webpack_require__(4),__webpack_require__(5),__webpack_require__(6)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=='undefined'){factory(exports,require('./core/base64.js'),require('./core/converter.js'),require('./core/file.js'),require('./core/image.js'),require('./core/Photo.js'),require('./core/rotate.js'))}else{var mod={exports:{}};factory(mod.exports,global.base64,global.converter,global.file,global.image,global.Photo,global.rotate);global.Compress=mod.exports}})(this,function(exports,_base,_converter,_file,_image,_Photo,_rotate){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _base2=_interopRequireDefault(_base);var _converter2=_interopRequireDefault(_converter);var _file2=_interopRequireDefault(_file);var _image2=_interopRequireDefault(_image);var _Photo2=_interopRequireDefault(_Photo);var _rotate2=_interopRequireDefault(_rotate);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var Compress=function(){function Compress(){_classCallCheck(this,Compress)}return _createClass(Compress,[{key:'attach',value:function attach(a,b,c){var _this=this;return new Promise(function(d){var f=document.querySelector(a);f.setAttribute('accept','image/*'),f.addEventListener('change',function(g){var h=_this.compress([].concat(_toConsumableArray(g.target.files)),b,c);d(h)},!1)})}},{key:'compress',value:function compress(a,b,c){function d(g,h){var i=new _Photo2.default(h);return i.start=window.performance.now(),i.alt=g.name,i.ext=g.type,i.startSize=g.size,_rotate2.default.orientation(g).then(function(j){return i.orientation=j,_file2.default.load(g)}).then(e(i))}function e(g){return function(h){return _image2.default.load(h).then(function(i){if(g.startWidth=i.naturalWidth,g.startHeight=i.naturalHeight,g.resize){var _Image$resize=_image2.default.resize(g.maxWidth,g.maxHeight)(i.naturalWidth,i.naturalHeight),j=_Image$resize.width,k=_Image$resize.height;g.endWidth=j,g.endHeight=k}else g.endWidth=i.naturalWidth,g.endHeight=i.naturalHeight;return _converter2.default.imageToCanvas(g.endWidth,g.endHeight,g.orientation)(i)}).then(function(i){return g.iterations=1,g.base64prefix=_base2.default.prefix(g.ext),f(i,g.startSize,g.quality,g.size,g.minQuality,g.iterations)}).then(function(i){return g.finalSize=_base2.default.size(i),_base2.default.data(i)}).then(function(i){g.end=window.performance.now();var j=g.end-g.start;return{data:i,prefix:g.base64prefix,elapsedTimeInSeconds:j/1e3,alt:g.alt,initialSizeInMb:_converter2.default.size(g.startSize).MB,endSizeInMb:_converter2.default.size(g.finalSize).MB,ext:g.ext,quality:g.quality,endWidthInPx:g.endWidth,endHeightInPx:g.endHeight,initialWidthInPx:g.startWidth,initialHeightInPx:g.startHeight,sizeReducedInPercent:100*((g.startSize-g.finalSize)/g.startSize),iterations:g.iterations}})}}function f(g){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,k=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,j=arguments[3],l=arguments[5],m=_converter2.default.canvasToBase64(g,i),n=_base2.default.size(m);return l+=1,n>j?f(g,n,i-0.1,j,k,l):i>k?f(g,n,i-0.1,j,k,l):0.5>i?m:m}return Promise.all(a.map(function(g){return'file'===c?d(g,b).then(function(h){return new window.File([Compress.convertBase64ToFile(h.data,h.ext)],h.alt,{type:h.ext})}):'blob'===c?d(g,b).then(function(h){return Compress.convertBase64ToFile(h.data,h.ext)}):d(g,b)}))}}],[{key:'convertBase64ToFile',value:function convertBase64ToFile(a,b){return _converter2.default.base64ToFile(a,b)}}]),Compress}();exports.default=Compress});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=='undefined'){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.base64=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var size=function(a){var b=a.replace(/^data:image\\/\\w+;base64,/,'').length;return(b-814)/1.37},mime=function(a){return a.split(';')[0].match(/jpeg|png|gif/)[0]},data=function(a){return a.replace(/^data:image\\/\\w+;base64,/,'')},prefix=function(a){return'data:'+a+';base64,'};exports.default={size:size,mime:mime,data:data,prefix:prefix}});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=='undefined'){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.converter=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var base64ToFile=function(a){for(var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'image/jpeg',c=window.atob(a),d=[],e=0;e<c.length;e++)d[e]=c.charCodeAt(e);return new window.Blob([new Uint8Array(d)],{type:b})},imageToCanvas=function(a,b,c){var d=document.createElement('canvas'),e=d.getContext('2d');return d.width=a,d.height=b,function(f){return!c||8<c?(e.drawImage(f,0,0,d.width,d.height),d):(4<c&&(d.width=b,d.height=a),2===c?(e.translate(a,0),e.scale(-1,1)):3===c?(e.translate(a,b),e.rotate(Math.PI)):4===c?(e.translate(0,b),e.scale(1,-1)):5===c?(e.rotate(0.5*Math.PI),e.scale(1,-1)):6===c?(e.rotate(0.5*Math.PI),e.translate(0,-b)):7===c?(e.rotate(0.5*Math.PI),e.translate(a,-b),e.scale(-1,1)):8===c?(e.rotate(-0.5*Math.PI),e.translate(-a,0)):void 0,(4<c?e.drawImage(f,0,0,d.height,d.width):e.drawImage(f,0,0,d.width,d.height),d))}},canvasToBase64=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0.75,c=a.toDataURL('image/jpeg',b);return c},size=function(a){return{KB:a/1e3,MB:a/1000000}};exports.default={base64ToFile:base64ToFile,imageToCanvas:imageToCanvas,canvasToBase64:canvasToBase64,size:size}});\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=='undefined'){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.file=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var load=function(a){return new Promise(function(b,c){var d=new window.FileReader;d.addEventListener('load',function(e){b(e.target.result)},!1),d.addEventListener('error',function(e){c(e)},!1),d.readAsDataURL(a)})};exports.default={load:load}});\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=='undefined'){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.image=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var load=function(a){return new Promise(function(b,c){var d=new window.Image;d.addEventListener('load',function(){b(d)},!1),d.addEventListener('error',function(e){c(e)},!1),d.src=a})},resize=function(a,b){return function(c,d){if(!a&&!b)return{width:c,height:d};var e=c/d,g=void 0,h=void 0;return e>a/b?(g=Math.min(c,a),h=g/e):(h=Math.min(d,b),g=h*e),{width:g,height:h}}};exports.default={load:load,resize:resize}});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!==\"undefined\"){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.Photo=mod.exports}})(this,function(exports){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError(\"Cannot call a class as a function\")}var Photo=function Photo(_ref){var _ref$quality=_ref.quality,a=void 0===_ref$quality?0.75:_ref$quality,_ref$size=_ref.size,b=void 0===_ref$size?2:_ref$size,_ref$maxWidth=_ref.maxWidth,c=void 0===_ref$maxWidth?1920:_ref$maxWidth,_ref$maxHeight=_ref.maxHeight,d=void 0===_ref$maxHeight?1920:_ref$maxHeight,_ref$resize=_ref.resize;_classCallCheck(this,Photo),this.start=window.performance.now(),this.end=null,this.alt=null,this.ext=null,this.startSize=null,this.startWidth=null,this.startHeight=null,this.size=1e3*(1e3*b),this.endSize=null,this.endWidth=null,this.endHeight=null,this.iterations=0,this.base64prefix=null,this.quality=a,this.resize=void 0===_ref$resize||_ref$resize,this.maxWidth=c,this.maxHeight=d,this.orientation=1};exports.default=Photo});\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!==\"undefined\"){factory(exports)}else{var mod={exports:{}};factory(mod.exports);global.rotate=mod.exports}})(this,function(exports){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});var orientation=function(a){return new Promise(function(b){var d=new window.FileReader;d.onload=function(e){var f=new DataView(e.target.result);65496!==f.getUint16(0,!1)&&b(-2);for(var j,g=f.byteLength,h=2;h<g;)if(j=f.getUint16(h,!1),h+=2,65505===j){1165519206!==f.getUint32(h+=2,!1)&&b(-1);var k=18761===f.getUint16(h+=6,!1);h+=f.getUint32(h+4,k);var l=f.getUint16(h,k);h+=2;for(var _m4=0;_m4<l;_m4++)274===f.getUint16(h+12*_m4,k)&&b(f.getUint16(h+12*_m4+8,k))}else if(65280!=(65280&j))break;else h+=f.getUint16(h,!1);b(-1)},d.readAsArrayBuffer(a.slice(0,65536))})};exports.default={orientation:orientation}});\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e38e4f621af35a4d30a2","import Base64 from './core/base64.js'\nimport Converter from './core/converter.js'\nimport File from './core/file.js'\nimport Image from './core/image.js'\nimport Photo from './core/Photo.js'\nimport Rotate from './core/rotate.js'\n\nclass Compress {\n  attach (el, options, outputType) {\n    return new Promise((resolve, reject) => {\n      const input = document.querySelector(el)\n      input.setAttribute('accept', 'image/*')\n      input.addEventListener('change', (evt) => {\n        const output = this.compress([...evt.target.files], options, outputType)\n        resolve(output)\n      }, false)\n    })\n  }\n\n  compress (files, options, outputType) {\n    function compressFile (file, options) {\n      // Create a new photo object\n      const photo = new Photo(options)\n      photo.start = window.performance.now()\n      photo.alt = file.name\n      photo.ext = file.type\n      photo.startSize = file.size\n\n      return Rotate.orientation(file)\n      .then((orientation) => {\n        photo.orientation = orientation\n        return File.load(file)\n      })\n      .then(compressImage(photo))\n    }\n    function compressImage (photo) {\n      return (src) => {\n        return Image.load(src).then((img) => {\n          // Store the initial dimensions\n          photo.startWidth = img.naturalWidth\n          photo.startHeight = img.naturalHeight\n          // Resize the image\n          if (photo.resize) {\n            const { width, height } = Image.resize(photo.maxWidth, photo.maxHeight)(img.naturalWidth, img.naturalHeight)\n            photo.endWidth = width\n            photo.endHeight = height\n          } else {\n            photo.endWidth = img.naturalWidth\n            photo.endHeight = img.naturalHeight\n          }\n          return Converter.imageToCanvas(photo.endWidth, photo.endHeight, photo.orientation)(img)\n        })\n        .then((canvas) => {\n          photo.iterations = 1\n          // Base64.mime(Converter.canvasToBase64(canvas))\n          photo.base64prefix = Base64.prefix(photo.ext)\n          return loopCompression(canvas, photo.startSize, photo.quality, photo.size, photo.minQuality, photo.iterations)\n        })\n        .then((base64) => {\n          photo.finalSize = Base64.size(base64)\n          return Base64.data(base64)\n        })\n        .then((data) => {\n          photo.end = window.performance.now()\n          const difference = photo.end - photo.start // in ms\n\n          return {\n            data: data,\n            prefix: photo.base64prefix,\n            elapsedTimeInSeconds: difference / 1000, // in seconds\n            alt: photo.alt,\n            initialSizeInMb: Converter.size(photo.startSize).MB,\n            endSizeInMb: Converter.size(photo.finalSize).MB,\n            ext: photo.ext,\n            quality: photo.quality,\n            endWidthInPx: photo.endWidth,\n            endHeightInPx: photo.endHeight,\n            initialWidthInPx: photo.startWidth,\n            initialHeightInPx: photo.startHeight,\n            sizeReducedInPercent: (photo.startSize - photo.finalSize) / photo.startSize * 100,\n            iterations: photo.iterations\n          }\n        })\n      }\n    }\n    function loopCompression (canvas, size, quality = 1, targetSize, targetQuality = 1, iterations) {\n      const base64str = Converter.canvasToBase64(canvas, quality)\n      const newSize = Base64.size(base64str)\n      // const base64str = convertCanvasToBase64(src)\n      // const size = getFileSize(base64str);\n      iterations += 1\n      // add in iteration count\n      if (newSize > targetSize) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality > targetQuality) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality < 0.5) {\n        return base64str\n      }\n      return base64str\n    }\n    return Promise.all(files.map((file) => {\n      if(outputType === 'file'){\n        return compressFile(file, options)\n               .then((file) => {\n                return new window.File([Compress.convertBase64ToFile(file.data, file.ext)], file.alt, {type:file.ext});\n              })\n      }\n      else if(outputType === 'blob'){\n        return compressFile(file, options)\n               .then((file) => {\n                return Compress.convertBase64ToFile(file.data, file.ext);\n              })  \n      }\n      return compressFile(file, options)\n    }))\n  }\n  static convertBase64ToFile (base64, mime) {\n    return Converter.base64ToFile(base64, mime)\n  }\n}\n\n// Supported input formats\n// image/png, image/jpeg, image/jpg, image/gif, image/bmp, image/tiff, image/x-icon,  image/svg+xml, image/webp, image/xxx\n// image/png, image/jpeg, image/webp\nexport default Compress\n\n\n\n// WEBPACK FOOTER //\n// ./src/Compress.js","const size = (base64) => {\n  const len = base64.replace(/^data:image\\/\\w+;base64,/, '').length\n  return (len - 814) / 1.37\n  // return len * 3 / 4\n}\n\n// strip off the data: url prefix to get just the base64-encoded bytes\n// var data = img.replace(/^data:image\\/\\w+;base64,/, \"\");\nconst mime = (base64) => {\n  return base64.split(';')[0].match(/jpeg|png|gif/)[0]\n}\n\nconst data = (base64) => {\n  return base64.replace(/^data:image\\/\\w+;base64,/, '')\n}\n\nconst prefix = (ext) => {\n  return `data:${ext};base64,`\n}\n\nexport default { size, mime, data, prefix }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/base64.js","\nconst base64ToFile = (base64, mime = 'image/jpeg') => {\n  const byteString = window.atob(base64)\n  const content = []\n  for (let i = 0; i < byteString.length; i++) {\n    content[i] = byteString.charCodeAt(i)\n  }\n  return new window.Blob([new Uint8Array(content)], {type: mime})\n}\n\nconst imageToCanvas = (width, height, orientation) => {\n  const canvas = document.createElement('canvas')\n  const context = canvas.getContext('2d')\n\n  canvas.width = width\n  canvas.height = height\n  // canvas.style.width = width\n  // canvas.style.height = height\n\n  return (image) => {\n    if (!orientation || orientation > 8) {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n      return canvas\n    }\n    if (orientation > 4) {\n      canvas.width = height\n      canvas.height = width\n      // canvas.style.width = height\n      // canvas.style.height = width\n    }\n    switch (orientation) {\n      case 2:\n        // horizontal flip\n        context.translate(width, 0)\n        context.scale(-1, 1)\n        break\n      case 3:\n        // 180° rotate left\n        context.translate(width, height)\n        context.rotate(Math.PI)\n        break\n      case 4:\n        // vertical flip\n        context.translate(0, height)\n        context.scale(1, -1)\n        break\n      case 5:\n        // vertical flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.scale(1, -1)\n        break\n      case 6:\n        // 90° rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(0, -height)\n        break\n      case 7:\n        // horizontal flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(width, -height)\n        context.scale(-1, 1)\n        break\n      case 8:\n        // 90° rotate left\n        context.rotate(-0.5 * Math.PI)\n        context.translate(-width, 0)\n        break\n    }\n    if (orientation > 4) {\n      context.drawImage(image, 0, 0, canvas.height, canvas.width)\n    } else {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n    }\n    return canvas\n  }\n}\n\nconst canvasToBase64 = (canvas, quality = 0.75) => {\n  // in order to compress the final image format has to be jpeg\n  const base64 = canvas.toDataURL('image/jpeg', quality)\n  return base64\n}\n\n// const canvasToImage = (canvas, quality=.75, mimeType='image/jpeg') => {\n//   const image = new Image()\n//   const base64str = canvas.toDataURL(mimeType, quality)\n//   image.src = base64str\n//   return image\n// }\n\nconst size = (size) => {\n  return {\n    KB: size / 1000,\n    MB: size / (1000 * 1000)\n  }\n}\n\nexport default { base64ToFile, imageToCanvas, canvasToBase64, size }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/converter.js","\nconst load = (file) => {\n  return new Promise((resolve, reject) => {\n    const fileReader = new window.FileReader()\n    fileReader.addEventListener('load', (evt) => {\n      resolve(evt.target.result)\n    }, false)\n\n    fileReader.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    fileReader.readAsDataURL(file)\n  })\n}\n\nexport default { load }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/file.js","\nconst load = (src) => {\n  return new Promise((resolve, reject) => {\n    const img = new window.Image()\n    img.addEventListener('load', () => {\n      resolve(img)\n    }, false)\n\n    img.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    img.src = src\n  })\n}\n  /*\n   * Resize the image based on the given height or width boundary.\n   * Auto resize based on aspect ratio.\n  **/\nconst resize = (targetWidth, targetHeight) => {\n  return (width, height) => {\n    if (!targetWidth && !targetHeight) return { width, height }\n\n    const originalAspectRatio = width / height\n    const targetAspectRatio = targetWidth / targetHeight\n\n    let outputWidth, outputHeight\n\n    if (originalAspectRatio > targetAspectRatio) {\n      outputWidth = Math.min(width, targetWidth)\n      outputHeight = outputWidth / originalAspectRatio\n    } else {\n      outputHeight = Math.min(height, targetHeight)\n      outputWidth = outputHeight * originalAspectRatio\n    }\n\n    return { width: outputWidth, height: outputHeight }\n  }\n}\n\nexport default { load, resize }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/image.js","// The photo model\nclass Photo {\n  constructor ({ quality = 0.75, size = 2, maxWidth = 1920, maxHeight = 1920, resize = true }) {\n    this.start = window.performance.now()\n    this.end = null\n\n    this.alt = null\n    this.ext = null\n    this.startSize = null\n    this.startWidth = null\n    this.startHeight = null\n    // How much will the quality decrease by each compression\n    // this.stepQuality = stepQuality\n\n    // size in MB\n    this.size = size * 1000 * 1000\n    this.endSize = null\n    this.endWidth = null\n    this.endHeight = null\n    this.iterations = 0\n    this.base64prefix = null\n    // Carry out image resizing\n    this.quality = quality\n    this.resize = resize\n    this.maxWidth = maxWidth\n    this.maxHeight = maxHeight\n    this.orientation = 1\n  }\n}\nexport default Photo\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/Photo.js","// https://stackoverflow.com/questions/20600800/js-client-side-exif-orientation-rotate-and-mirror-jpeg-images/31273162#31273162\n\nconst orientation = (file) => {\n  return new Promise((resolve, reject) => {\n    const reader = new window.FileReader()\n\n    reader.onload = function (event) {\n      var view = new DataView(event.target.result)\n\n      if (view.getUint16(0, false) !== 0xFFD8) {\n        resolve(-2)\n      }\n      const length = view.byteLength\n      let offset = 2\n\n      while (offset < length) {\n        const marker = view.getUint16(offset, false)\n        offset += 2\n\n        if (marker === 0xFFE1) {\n          if (view.getUint32(offset += 2, false) !== 0x45786966) {\n            resolve(-1)\n          }\n          const little = view.getUint16(offset += 6, false) === 0x4949\n          offset += view.getUint32(offset + 4, little)\n          const tags = view.getUint16(offset, little)\n          offset += 2\n\n          for (let i = 0; i < tags; i++) {\n            if (view.getUint16(offset + (i * 12), little) === 0x0112) {\n              resolve(view.getUint16(offset + (i * 12) + 8, little))\n            }\n          }\n        } else if ((marker & 0xFF00) !== 0xFF00) break\n        else offset += view.getUint16(offset, false)\n      }\n      resolve(-1)\n    }\n    reader.readAsArrayBuffer(file.slice(0, 64 * 1024))\n  })\n}\n\nexport default { orientation }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/rotate.js"],"sourceRoot":""}