var D=(a,B)=>()=>(a&&(B=a(a=0)),B);var P={};var R=D(()=>{/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-exiforientation-setclasses !*/(function(a,B,u){function h(n,A){return typeof n===A}function i(){var n,A,r,c,p,f,Q;for(var y in s)if(s.hasOwnProperty(y)){if(n=[],A=s[y],A.name&&(n.push(A.name.toLowerCase()),A.options&&A.options.aliases&&A.options.aliases.length))for(r=0;r<A.options.aliases.length;r++)n.push(A.options.aliases[r].toLowerCase());for(c=h(A.fn,"function")?A.fn():A.fn,p=0;p<n.length;p++)f=n[p],Q=f.split("."),Q.length===1?t[Q[0]]=c:(!t[Q[0]]||t[Q[0]]instanceof Boolean||(t[Q[0]]=new Boolean(t[Q[0]])),t[Q[0]][Q[1]]=c),e.push((c?"":"no-")+Q.join("-"))}}function E(n){var A=g.className,r=t._config.classPrefix||"";if(m&&(A=A.baseVal),t._config.enableJSClass){var c=new RegExp("(^|\\s)"+r+"no-js(\\s|$)");A=A.replace(c,"$1"+r+"js$2")}t._config.enableClasses&&(A+=" "+r+n.join(" "+r),m?g.className.baseVal=A:g.className=A)}function o(n,A){if(typeof n=="object")for(var r in n)w(n,r)&&o(r,n[r]);else{n=n.toLowerCase();var c=n.split("."),p=t[c[0]];if(c.length==2&&(p=p[c[1]]),typeof p!="undefined")return t;A=typeof A=="function"?A():A,c.length==1?t[c[0]]=A:(!t[c[0]]||t[c[0]]instanceof Boolean||(t[c[0]]=new Boolean(t[c[0]])),t[c[0]][c[1]]=A),E([(A&&A!=0?"":"no-")+c.join("-")]),t._trigger(n,A)}return t}var e=[],s=[],d={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(n,A){var r=this;setTimeout(function(){A(r[n])},0)},addTest:function(n,A,r){s.push({name:n,fn:A,options:r})},addAsyncTest:function(n){s.push({name:null,fn:n})}},t=function(){};t.prototype=d,t=new t;var w,g=B.documentElement,m=g.nodeName.toLowerCase()==="svg";(function(){var n={}.hasOwnProperty;w=h(n,"undefined")||h(n.call,"undefined")?function(A,r){return r in A&&h(A.constructor.prototype[r],"undefined")}:function(A,r){return n.call(A,r)}})(),d._l={},d.on=function(n,A){this._l[n]||(this._l[n]=[]),this._l[n].push(A),t.hasOwnProperty(n)&&setTimeout(function(){t._trigger(n,t[n])},0)},d._trigger=function(n,A){if(this._l[n]){var r=this._l[n];setTimeout(function(){var c,p;for(c=0;c<r.length;c++)(p=r[c])(A)},0),delete this._l[n]}},t._q.push(function(){d.addTest=o}),t.addAsyncTest(function(){var n=new Image;n.onerror=function(){o("exiforientation",!1,{aliases:["exif-orientation"]})},n.onload=function(){o("exiforientation",n.width!==2,{aliases:["exif-orientation"]})},n.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAASUkqAAgAAAABABIBAwABAAAABgASAAAAAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAABAAIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+/iiiigD/2Q=="}),i(),E(e),delete d.addTest,delete d.addAsyncTest;for(var l=0;l<t._q.length;l++)t._q[l]();a.Modernizr=t})(window,document)});async function C(a,{quality:B=1}={}){if(Modernizr.exiforientation)return a;const u=await U(a);return new Promise((h)=>{const i=new Image;i.onload=async function(){const{naturalWidth:E,naturalHeight:o}=i,e=document.createElement("canvas"),s=e.getContext("2d");if(e.width=E,e.height=o,u>4)e.width=o,e.height=E;switch(u){case 2:s.translate(E,0),s.scale(-1,1);break;case 3:s.translate(E,o),s.rotate(Math.PI);break;case 4:s.translate(0,o),s.scale(1,-1);break;case 5:s.rotate(0.5*Math.PI),s.scale(1,-1);break;case 6:s.rotate(0.5*Math.PI),s.translate(0,-o);break;case 7:s.rotate(0.5*Math.PI),s.translate(E,-o),s.scale(-1,1);break;case 8:s.rotate(-0.5*Math.PI),s.translate(-E,0);break}if(u>4)s.drawImage(i,0,0,e.height,e.width);else s.drawImage(i,0,0,e.width,e.height);e.toBlob((d)=>{const t=new File([d],a.name,{type:a.type,lastModified:Date.now()});if(t.size>a.size)console.log("Compression failed",t.size,a.size),h(t);else h(t)},a.type,B)},i.src=URL.createObjectURL(a)})}var U=function(a){return new Promise((B)=>{const u=new FileReader;u.onload=function(h){var i=new DataView(h.target.result);if(i.getUint16(0,!1)!==65496)B(-2);const E=i.byteLength;let o=2;while(o<E){const e=i.getUint16(o,!1);if(o+=2,e===65505){if(i.getUint32(o+=2,!1)!==1165519206)B(-1);const s=i.getUint16(o+=6,!1)===18761;o+=i.getUint32(o+4,s);const d=i.getUint16(o,s);o+=2;for(let t=0;t<d;t++)if(i.getUint16(o+t*12,s)===274)B(i.getUint16(o+t*12+8,s))}else if((e&65280)!==65280)break;else o+=i.getUint16(o,!1)}B(-1)},u.readAsArrayBuffer(a.slice(0,65536))})};try{await Promise.resolve().then(() => (R(),P))}catch(a){console.error(a),globalThis.Modernizr={exiforientation:!1}}function I(a,{quality:B=0.95}={}){return new Promise((u)=>{const h=new Image;h.onload=async function(){const i={width:h.naturalWidth,height:h.naturalHeight},E=Math.min(i.width,i.height),o={width:E,height:E,left:0,top:0};if(i.width>i.height)o.left=(i.width-E)/2;else o.top=(i.height-E)/2;const e=document.createElement("canvas");e.width=o.width,e.height=o.height,e.getContext("2d").drawImage(h,o.left,o.top,h.width,h.height,0,0,h.width,h.height),e.toBlob((d)=>{u(new File([d],a.name,{type:a.type,lastModified:Date.now()}))},a.type,B)},h.src=URL.createObjectURL(a)})}function _(a,{quality:B=0.95,maxWidth:u=null,maxHeight:h=null}={}){return new Promise((i,E)=>{const o=new Image;o.onload=async function(){const e={width:o.naturalWidth,height:o.naturalHeight},s={width:u||e.width,height:h||e.height},d=Math.min(1,s.width/e.width,s.height/e.height);s.width=e.width*d,s.height=e.height*d;const t=document.createElement("canvas");t.width=s.width,t.height=s.height,t.getContext("2d").drawImage(o,0,0,s.width,s.height),t.toBlob((g)=>{const m=new File([g],a.name,{type:a.type,lastModified:Date.now()});if(m.size>a.size)E("Compression failed");else i(m)},a.type,B)},o.src=URL.createObjectURL(a)})}class x{constructor({maxWidth:a,maxHeight:B,quality:u=0.95,crop:h=!1}={}){this.maxWidth=a,this.maxHeight=B,this.quality=u,this.crop=h}async compress(a,B){const u={maxWidth:this.maxWidth,maxHeight:this.maxHeight,quality:this.quality,crop:this.crop,...B},h=[C];if(u.crop)h.push(I);h.push(_);for(let i of h)a=await i(a,u);return a}}export{x as default};
