/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-exiforientation-setclasses !*/(function(e,u,d){function i(t,n){return typeof t===n}function r(){var t,n,h,B,p,f,Q;for(var y in a)if(a.hasOwnProperty(y)){if(t=[],n=a[y],n.name&&(t.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(h=0;h<n.options.aliases.length;h++)t.push(n.options.aliases[h].toLowerCase());for(B=i(n.fn,"function")?n.fn():n.fn,p=0;p<t.length;p++)f=t[p],Q=f.split("."),Q.length===1?A[Q[0]]=B:(!A[Q[0]]||A[Q[0]]instanceof Boolean||(A[Q[0]]=new Boolean(A[Q[0]])),A[Q[0]][Q[1]]=B),c.push((B?"":"no-")+Q.join("-"))}}function E(t){var n=m.className,h=A._config.classPrefix||"";if(w&&(n=n.baseVal),A._config.enableJSClass){var B=new RegExp("(^|\\s)"+h+"no-js(\\s|$)");n=n.replace(B,"$1"+h+"js$2")}A._config.enableClasses&&(n+=" "+h+t.join(" "+h),w?m.className.baseVal=n:m.className=n)}function o(t,n){if(typeof t=="object")for(var h in t)g(t,h)&&o(h,t[h]);else{t=t.toLowerCase();var B=t.split("."),p=A[B[0]];if(B.length==2&&(p=p[B[1]]),typeof p!="undefined")return A;n=typeof n=="function"?n():n,B.length==1?A[B[0]]=n:(!A[B[0]]||A[B[0]]instanceof Boolean||(A[B[0]]=new Boolean(A[B[0]])),A[B[0]][B[1]]=n),E([(n&&n!=0?"":"no-")+B.join("-")]),A._trigger(t,n)}return A}var c=[],a=[],s={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,n){var h=this;setTimeout(function(){n(h[t])},0)},addTest:function(t,n,h){a.push({name:t,fn:n,options:h})},addAsyncTest:function(t){a.push({name:null,fn:t})}},A=function(){};A.prototype=s,A=new A;var g,m=u.documentElement,w=m.nodeName.toLowerCase()==="svg";(function(){var t={}.hasOwnProperty;g=i(t,"undefined")||i(t.call,"undefined")?function(n,h){return h in n&&i(n.constructor.prototype[h],"undefined")}:function(n,h){return t.call(n,h)}})(),s._l={},s.on=function(t,n){this._l[t]||(this._l[t]=[]),this._l[t].push(n),A.hasOwnProperty(t)&&setTimeout(function(){A._trigger(t,A[t])},0)},s._trigger=function(t,n){if(this._l[t]){var h=this._l[t];setTimeout(function(){var B,p;for(B=0;B<h.length;B++)(p=h[B])(n)},0),delete this._l[t]}},A._q.push(function(){s.addTest=o}),A.addAsyncTest(function(){var t=new Image;t.onerror=function(){o("exiforientation",!1,{aliases:["exif-orientation"]})},t.onload=function(){o("exiforientation",t.width!==2,{aliases:["exif-orientation"]})},t.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAASUkqAAgAAAABABIBAwABAAAABgASAAAAAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAABAAIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+/iiiigD/2Q=="}),r(),E(c),delete s.addTest,delete s.addAsyncTest;for(var l=0;l<A._q.length;l++)A._q[l]();e.Modernizr=A})(window,document);async function R(e,{quality:u=1}={}){if(Modernizr.exiforientation)return e;const d=await x(e);return new Promise((i,r)=>{const E=new Image;E.onload=async function(){const{naturalWidth:o,naturalHeight:c}=E,a=document.createElement("canvas"),s=a.getContext("2d");if(a.width=o,a.height=c,d>4)a.width=c,a.height=o;switch(d){case 2:s.translate(o,0),s.scale(-1,1);break;case 3:s.translate(o,c),s.rotate(Math.PI);break;case 4:s.translate(0,c),s.scale(1,-1);break;case 5:s.rotate(0.5*Math.PI),s.scale(1,-1);break;case 6:s.rotate(0.5*Math.PI),s.translate(0,-c);break;case 7:s.rotate(0.5*Math.PI),s.translate(o,-c),s.scale(-1,1);break;case 8:s.rotate(-0.5*Math.PI),s.translate(-o,0);break}if(d>4)s.drawImage(E,0,0,a.height,a.width);else s.drawImage(E,0,0,a.width,a.height);a.toBlob((A)=>{const g=new File([A],e.name,{type:e.type,lastModified:Date.now()});if(g.size>e.size)console.log("Compression failed",g.size,e.size),i(g);else i(g)},e.type,u)},E.src=URL.createObjectURL(e)})}var x=function(e){return new Promise((u)=>{const d=new window.FileReader;d.onload=function(i){var r=new DataView(i.target.result);if(r.getUint16(0,!1)!==65496)u(-2);const E=r.byteLength;let o=2;while(o<E){const c=r.getUint16(o,!1);if(o+=2,c===65505){if(r.getUint32(o+=2,!1)!==1165519206)u(-1);const a=r.getUint16(o+=6,!1)===18761;o+=r.getUint32(o+4,a);const s=r.getUint16(o,a);o+=2;for(let A=0;A<s;A++)if(r.getUint16(o+A*12,a)===274)u(r.getUint16(o+A*12+8,a))}else if((c&65280)!==65280)break;else o+=r.getUint16(o,!1)}u(-1)},d.readAsArrayBuffer(e.slice(0,65536))})};function C(e,{quality:u=0.95}={}){return new Promise((d)=>{const i=new Image;i.onload=async function(){const r={width:i.naturalWidth,height:i.naturalHeight},E=Math.min(r.width,r.height),o={width:E,height:E,left:0,top:0};if(r.width>r.height)o.left=(r.width-E)/2;else o.top=(r.height-E)/2;const c=document.createElement("canvas");c.width=o.width,c.height=o.height,c.getContext("2d").drawImage(i,o.left,o.top,i.width,i.height,0,0,i.width,i.height),c.toBlob((s)=>{d(new File([s],e.name,{type:e.type,lastModified:Date.now()}))},e.type,u)},i.src=URL.createObjectURL(e)})}function I(e,{quality:u=0.95,maxWidth:d=null,maxHeight:i=null}={}){return new Promise((r,E)=>{const o=new Image;o.onload=async function(){const c={width:o.naturalWidth,height:o.naturalHeight},a={width:d||c.width,height:i||c.height},s=Math.min(1,a.width/c.width,a.height/c.height);a.width=c.width*s,a.height=c.height*s;const A=document.createElement("canvas");A.width=a.width,A.height=a.height,A.getContext("2d").drawImage(o,0,0,a.width,a.height),A.toBlob((m)=>{const w=new File([m],e.name,{type:e.type,lastModified:Date.now()});if(w.size>e.size)E("Compression failed");else r(w)},e.type,u)},o.src=URL.createObjectURL(e)})}class _{constructor({maxWidth:e,maxHeight:u,quality:d=0.95,crop:i=!1}={}){this.maxWidth=e,this.maxHeight=u,this.quality=d,this.crop=i}async compress(e,u){const d={maxWidth:this.maxWidth,maxHeight:this.maxHeight,quality:this.quality,crop:this.crop,...u},i=[R];if(d.crop)i.push(C);i.push(I);for(let r of i)e=await r(e,d);return e}}export{_ as default};
